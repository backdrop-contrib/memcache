<?php

function memcache_taxonomy($op, $type, $object=NULL) {
  if (is_null($object)) {
    return;
  }
  $object = (array)$object;

  switch ($type) {
    case 'term':
    $key = $object['tid'];
    break;

    case 'vocabulary':
    $key = $object['vid'];
    break;

    // we only know how to handle 'term' and 'vocabulary', so return otherwise.
    default:
    return;
  }
  switch ($op) {
    case 'delete':
    case 'update':
    dmemcache_flush($key, 'taxonomy_get_tree');
    dmemcache_delete($key, $type);
  }

}

function memcache_nodeapi($node, $op) {
  switch ($op) {
    case 'insert':
    case 'update':
    case 'delete':
    dmemcache_delete($node->nid, 'node');
  }
}
